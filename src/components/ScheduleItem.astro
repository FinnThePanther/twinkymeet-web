---
import type { Activity } from '../lib/db';

interface Props {
  activity: Activity;
}

const { activity } = Astro.props;

// Format time to display
const formatTime = (datetime?: string) => {
  if (!datetime) return 'TBA';
  return new Date(datetime).toLocaleTimeString('en-US', {
    hour: 'numeric',
    minute: '2-digit',
    hour12: true
  });
};

// Badge color based on activity type
const getBadgeColor = (type?: string) => {
  const colors: Record<string, string> = {
    gaming: 'bg-purple-100 text-purple-800',
    outdoor: 'bg-green-100 text-green-800',
    creative: 'bg-pink-100 text-pink-800',
    social: 'bg-blue-100 text-blue-800',
    '18+': 'bg-red-100 text-red-800',
  };
  return colors[type || ''] || 'bg-gray-100 text-gray-800';
};
---

<div class="bg-white border-l-4 border-indigo-500 shadow-sm rounded-r-lg p-4 hover:shadow-md transition-shadow">
  <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-3">
    <!-- Time & Location -->
    <div class="flex-shrink-0 md:w-48">
      <div class="text-lg font-semibold text-indigo-600">
        {formatTime(activity.scheduled_start)} - {formatTime(activity.scheduled_end)}
      </div>
      {activity.location && (
        <div class="text-sm text-gray-600 mt-1 flex items-center">
          <svg class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          {activity.location}
        </div>
      )}
    </div>

    <!-- Activity Details -->
    <div class="flex-1 min-w-0">
      <div class="flex items-start justify-between gap-2 mb-2">
        <h3 class="text-lg font-semibold text-gray-900">{activity.title}</h3>
        {activity.activity_type && (
          <span class={`px-2 py-1 text-xs font-semibold rounded-full whitespace-nowrap ${getBadgeColor(activity.activity_type)}`}>
            {activity.activity_type}
          </span>
        )}
      </div>

      {activity.description && (
        <p class="text-gray-600 text-sm mb-2 line-clamp-2">{activity.description}</p>
      )}

      <div class="flex items-center text-sm text-gray-500">
        <svg class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
        </svg>
        <span>Hosted by {activity.host_name}</span>
        {activity.capacity && (
          <span class="ml-3">â€¢ Max {activity.capacity} participants</span>
        )}
      </div>
    </div>
  </div>
</div>
