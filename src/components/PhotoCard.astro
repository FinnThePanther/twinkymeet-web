---
import { Image } from 'astro:assets';

interface Props {
  image: ImageMetadata;
  caption?: string;
  aspectRatio?: 'square' | 'landscape' | 'portrait';
  showCaptionOnHover?: boolean;
}

const {
  image,
  caption,
  aspectRatio = 'landscape',
  showCaptionOnHover = false,
} = Astro.props;

const aspectRatioClass = {
  square: 'aspect-square',
  landscape: 'aspect-video',
  portrait: 'aspect-[3/4]',
}[aspectRatio];
---

<div
  class="photo-card group image-zoom relative overflow-hidden rounded-lg shadow-md transition-shadow duration-300 hover:shadow-xl"
>
  <!-- Photo -->
  <div class={`w-full ${aspectRatioClass} overflow-hidden bg-gray-200`}>
    <Image
      src={image}
      alt={caption || 'TwinkyMeet photo'}
      class="h-full w-full object-cover object-top"
      widths={[400, 800]}
      sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
      loading="lazy"
      decoding="async"
    />
  </div>

  <!-- Caption -->
  {
    caption && (
      <div
        class={`absolute right-0 bottom-0 left-0 bg-gradient-to-t from-black to-transparent p-4 transition-opacity duration-300 ${
          showCaptionOnHover
            ? 'opacity-0 group-hover:opacity-100'
            : 'opacity-100'
        }`}
      >
        <p class="text-sm font-medium text-white drop-shadow-lg md:text-base">
          {caption}
        </p>
      </div>
    )
  }
</div>

<style>
  .photo-card img {
    transition: transform 0.3s ease;
  }

  .photo-card:hover img {
    transform: scale(1.05);
  }
</style>
