---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getSetting, getAllActivities } from '../lib/db';

// Fetch event details from settings
const eventDateStart = getSetting('event_date_start') || '2026-07-01';
const eventDateEnd = getSetting('event_date_end') || '2026-07-05';
const location = getSetting('location') || 'Location TBD';

// Format dates for display
const formatDate = (dateStr: string) => {
  const date = new Date(dateStr);
  return date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
};

const startDate = new Date(eventDateStart);
const endDate = new Date(eventDateEnd);
const dateDisplay = `${startDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric' })}-${endDate.getDate()}, ${endDate.getFullYear()}`;

// Get sample activities for highlights (upcoming scheduled activities)
const scheduledActivities = getAllActivities('scheduled').slice(0, 3);
---

<BaseLayout title="TwinkyMeet - Home">
	<div class="bg-gradient-to-b from-indigo-50 to-white">
		<!-- Hero Section -->
		<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center">
			<h1 class="text-5xl md:text-6xl font-bold text-gray-900 mb-4">
				Welcome to <span class="text-indigo-600">TwinkyMeet</span>
			</h1>
			<p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
				A summer mini-convention for our close-knit furry community gathering
			</p>

			<!-- Event Details -->
			<div class="flex flex-col sm:flex-row justify-center items-center gap-6 text-gray-700 mb-12">
				<div class="flex items-center">
					<svg class="w-6 h-6 mr-2 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
					</svg>
					<span class="font-medium">{dateDisplay}</span>
				</div>
				<div class="flex items-center">
					<svg class="w-6 h-6 mr-2 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
					</svg>
					<span class="font-medium">{location}</span>
				</div>
			</div>

			<!-- CTA Buttons -->
			<div class="flex flex-col sm:flex-row justify-center gap-4">
				<a
					href="/rsvp"
					class="inline-block bg-indigo-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors shadow-md"
				>
					RSVP Now
				</a>
				<a
					href="/submit-activity"
					class="inline-block bg-white text-indigo-600 px-8 py-3 rounded-lg font-semibold border-2 border-indigo-600 hover:bg-indigo-50 transition-colors"
				>
					Submit Activity
				</a>
			</div>
		</section>

		<!-- Quick Info Section -->
		<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
			<div class="grid md:grid-cols-3 gap-8">
				<div class="bg-white p-6 rounded-lg shadow-md">
					<div class="text-indigo-600 mb-3">
						<svg class="w-12 h-12 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
						</svg>
					</div>
					<h3 class="text-xl font-semibold text-gray-900 mb-2 text-center">View Schedule</h3>
					<p class="text-gray-600 text-center mb-4">Check out the planned activities and events</p>
					<div class="text-center">
						<a href="/schedule" class="text-indigo-600 hover:text-indigo-700 font-medium">View Schedule →</a>
					</div>
				</div>

				<div class="bg-white p-6 rounded-lg shadow-md">
					<div class="text-indigo-600 mb-3">
						<svg class="w-12 h-12 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
						</svg>
					</div>
					<h3 class="text-xl font-semibold text-gray-900 mb-2 text-center">Event Info</h3>
					<p class="text-gray-600 text-center mb-4">Learn more about what to expect</p>
					<div class="text-center">
						<a href="/about" class="text-indigo-600 hover:text-indigo-700 font-medium">Learn More →</a>
					</div>
				</div>

				<div class="bg-white p-6 rounded-lg shadow-md">
					<div class="text-indigo-600 mb-3">
						<svg class="w-12 h-12 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5M12 21l-2-1m2 1l2-1m-2 1v-2.5M6 18l-2-1v-2.5M18 18l2-1v-2.5" />
						</svg>
					</div>
					<h3 class="text-xl font-semibold text-gray-900 mb-2 text-center">Activities</h3>
					<p class="text-gray-600 text-center mb-4">Browse all planned activities</p>
					<div class="text-center">
						<a href="/activities" class="text-indigo-600 hover:text-indigo-700 font-medium">View Activities →</a>
					</div>
				</div>
			</div>
		</section>

		<!-- Activity Highlights -->
		{scheduledActivities.length > 0 && (
			<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 bg-white">
				<h2 class="text-3xl font-bold text-gray-900 text-center mb-8">Featured Activities</h2>
				<div class="grid md:grid-cols-3 gap-6">
					{scheduledActivities.map(activity => (
						<div class="border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow">
							<h3 class="text-lg font-semibold text-gray-900 mb-2">{activity.title}</h3>
							<p class="text-sm text-gray-600 mb-3 line-clamp-2">{activity.description}</p>
							<div class="text-sm text-gray-500">
								<span class="font-medium">Host:</span> {activity.host_name}
							</div>
						</div>
					))}
				</div>
				<div class="text-center mt-8">
					<a href="/activities" class="text-indigo-600 hover:text-indigo-700 font-medium">
						View All Activities →
					</a>
				</div>
			</section>
		)}
	</div>
</BaseLayout>
